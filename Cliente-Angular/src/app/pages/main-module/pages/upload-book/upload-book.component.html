<div class="container bg-white my-3">
    <div class="row">
        <div class="col my-3">
            <h2 *ngIf="!idBook" class="text-center">Subir libro</h2>
            <h2 *ngIf="idBook" class="text-center">Modificar libro</h2>
        </div>
    </div>

    <form [formGroup]="uploadBookForm" class="row d-flex justify-content-center">
        <div class="col-4 m-1">
            <div class="row bgPrimario">
                <div class="col py-2 d-flex justify-content-center">
                    <img *ngIf="!bookImg" src="/assets/images/DefaultBook.png" alt="">
                    <img *ngIf="bookImg" src="data:image/jpg;base64,{{bookImg}}" alt="">
                </div>
            </div>
            <div class="row bgPrimario my-3">
                <div class="col my-1">
                    <input type="file" (change)="saveImage()" id="inputImg">
                </div>
            </div>
            <div class="row bgPrimario my-3">
                <div class="col-12 my-2">
                    <label [style]="(submitted && myForm['price'].errors) ? 'color:red;' : ''"
                        for="titulo">Precio:</label>
                </div>
                <div class="col-12 mb-2">
                    <input [value]="book.price" formControlName="price" type="text">
                </div>
            </div>
        </div>

        <div class="col-6">
            <div class="row bgPrimario m-1">
                <div class="col-12 my-2">
                    <label [style]="(submitted && myForm['title'].errors) ? 'color:red;' : ''"
                        for="titulo">Título:</label>
                </div>
                <div class="col-12 mb-2">
                    <input [value]="book.title" formControlName="title" type="text">
                </div>
            </div>
            <div class="row bgPrimario mt-3 m-1">
                <div class="col-12 my-2">
                    <label [style]="(submitted && myForm['author'].errors) ? 'color:red;' : ''"
                        for="autor">Autor:</label>
                </div>
                <div class="col-12 mb-2">
                    <input [value]="book.author" formControlName="author" type="text">
                </div>
            </div>
            <div class="row bgPrimario mt-3 m-1">
                <div class="col-12 my-2">
                    <label [style]="(submitted && myForm['description'].errors) ? 'color:red;' : ''" for="desc">Una
                        breve descripción:</label>
                </div>
                <div class="col-12 mb-2">
                    <textarea [value]="book.description" formControlName="description"></textarea>
                </div>
            </div>

            <div class="row bgPrimario mt-3 m-1">
                <div class="col-12 my-2">
                    <label [style]="(submitted && !stars) ? 'color:red;' : ''" for="autor">Estado:</label>
                </div>
                <div class="col-12 mb-2 d-flex justify-content-center">
                    <div class="valorador row bg-white">
                        <div class="col-6 d-flex justify-content-end">
                            <p *ngIf="!stars">Valorar el libro</p>
                            <p *ngIf="stars == 1">Muy mal estado</p>
                            <p *ngIf="stars == 2">Mal estado</p>
                            <p *ngIf="stars == 3">Buen estado</p>
                            <p *ngIf="stars == 4">Muy buen estado</p>
                            <p *ngIf="stars == 5">Como nuevo</p>
                        </div>
                        <div class="col-6">
                            <i (click)="stars = 1" [class]="stars >= 1? 'mx-1 bi bi-star-fill' : 'mx-1 bi bi-star'"></i>
                            <i (click)="stars = 2" [class]="stars >= 2? 'mx-1 bi bi-star-fill' : 'mx-1 bi bi-star'"></i>
                            <i (click)="stars = 3" [class]="stars >= 3? 'mx-1 bi bi-star-fill' : 'mx-1 bi bi-star'"></i>
                            <i (click)="stars = 4" [class]="stars >= 4? 'mx-1 bi bi-star-fill' : 'mx-1 bi bi-star'"></i>
                            <i (click)="stars = 5" [class]="stars >= 5? 'mx-1 bi bi-star-fill' : 'mx-1 bi bi-star'"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <div class="errorForm row d-flex justify-content-center mb-3" *ngIf="submitted && !uploadBookForm.valid">
        <div class="col-12 d-flex justify-content-center">
            <h5>Ha habido un error en los siguientes campos:</h5>
        </div>

        <div class="col-12 col-sm-6 d-flex justify-content-center" *ngIf="submitted && myForm['title'].errors">
            <div *ngIf="myForm['title'].errors['required']">
                *Debes escribir un título para tu libro
            </div>
        </div>
        <div class="col-12 col-sm-6 d-flex justify-content-center" *ngIf="submitted && myForm['author'].errors">
            <div *ngIf="myForm['author'].errors['required']">
                *Debes escribir el autor de tu libro
            </div>
        </div>
        <div class="col-12 col-sm-6 d-flex justify-content-center" *ngIf="submitted && myForm['description'].errors">
            <div *ngIf="myForm['description'].errors['required']">
                *Debes escribir una descripción para tu libro
            </div>
            <div *ngIf="myForm['description'].errors['minlength']">
                *Escribe una descripción de al menos 100 caracteres
            </div>
            <div *ngIf="myForm['description'].errors['maxlength']">
                *Escribe una descripción de menos de 500 caracteres
            </div>
        </div>
        <div class="col-12 col-sm-6 d-flex justify-content-center" *ngIf="submitted && myForm['price'].errors">
            <div *ngIf="myForm['price'].errors['required']">
                *Debes de ponerle precio a tu libro
            </div>
            <div *ngIf="myForm['price'].errors['pattern']">
                *Escribe un precio válido ej: 12.50
            </div>
        </div>
        <div class="col-12 col-sm-6 d-flex justify-content-center" *ngIf="submitted && !stars">
            *Debes de calificar el estado de tu libro
        </div>
        <div class="col-12 col-sm-6 d-flex justify-content-center" *ngIf="submitted && !bookImg">
            *Debes de subir una imagen de tu libro
        </div>
    </div>

    <div *ngIf="!idBook" class="row">
        <div class="col d-flex justify-content-center">
            <button class="btn bgSecundario mb-4" (click)="registerBook()">
                Subir libro <i class="bi bi-arrow-up-circle"></i>
            </button>
        </div>
    </div>
    <div *ngIf="idBook" class="row d-flex justify-content-around">
        <div class="col-5 d-flex justify-content-end mb-4">
            <button (click)="modifyBook()" class="btn bgSecundario">Actualizar libro <i
                    class="bi bi-arrow-repeat"></i></button>
        </div>
        <div class="col-5 d-flex justify-content-start mb-4">
            <button class="btn outlineSecondary">Eliminar libro <i class="bi bi-trash"></i></button>
        </div>
    </div>

</div>